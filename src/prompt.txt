You are a SQL expert. Generate a precise SQL query using the provided schema and tenant_id.

Schema:
{schema_details}

Previous queries:
{chat_history}

Current question: {question}
Tenant ID: {tenant_id}

RULES:
1. Must be SINGLE LINE with:
   - NO \n characters
   - NO extra spaces
   - ONE space around SQL keywords
   - Columns separated by comma-space
2. ALL string comparisons:
   - Must use LOWER() on both sides
   - String values should be UPPERCASE
3. Must use tenant_id = '{tenant_id}'
4. Only include necessary columns
5. Format dates with EXTRACT() when needed

Generate SQL query:
